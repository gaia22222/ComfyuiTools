<!DOCTYPE html>
<html lang="zh-TW" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My ToolHub - å€‹äººå·¥å…·ç®±</title>
    
    <!-- å¼•å…¥ Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- å¼•å…¥ Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        slate: {
                            850: '#1e293b',
                            900: '#0f172a',
                            950: '#020617',
                        }
                    },
                    animation: {
                        'fade-in': 'fadeIn 0.3s ease-out',
                        'slide-up': 'slideUp 0.4s ease-out',
                    },
                    keyframes: {
                        fadeIn: {
                            '0%': { opacity: '0' },
                            '100%': { opacity: '1' },
                        },
                        slideUp: {
                            '0%': { opacity: '0', transform: 'translateY(10px)' },
                            '100%': { opacity: '1', transform: 'translateY(0)' },
                        }
                    }
                }
            }
        }
    </script>

    <style>
        body {
            background-color: #020617;
            color: #e2e8f0;
            font-family: 'Inter', system-ui, -apple-system, sans-serif;
            overflow: hidden; /* é˜²æ­¢é›™é‡æ»¾å‹•æ¢ */
        }
        
        .glass-panel {
            background: rgba(30, 41, 59, 0.4);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .tool-card {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .tool-card:hover {
            transform: translateY(-4px);
            background: rgba(30, 41, 59, 0.8);
            border-color: rgba(59, 130, 246, 0.5);
            box-shadow: 0 10px 40px -10px rgba(59, 130, 246, 0.15);
        }

        /* Iframe å®¹å™¨æ¨£å¼ */
        #app-frame-container {
            transition: transform 0.3s ease, opacity 0.3s ease;
        }
        #app-frame-container.hidden-app {
            transform: translateX(100%);
            opacity: 0;
            pointer-events: none;
            position: absolute;
        }
        #app-frame-container.active-app {
            transform: translateX(0);
            opacity: 1;
            position: absolute;
        }
        
        /* å„€è¡¨æ¿å®¹å™¨æ¨£å¼ */
        #dashboard-container {
            transition: transform 0.3s ease, opacity 0.3s ease;
        }
        #dashboard-container.hidden-dash {
            transform: translateX(-20%);
            opacity: 0;
            pointer-events: none;
        }
    </style>
</head>
<body class="flex h-screen w-screen selection:bg-blue-500/30">

    <!-- å´é‚Šå°èˆªæ¬„ -->
    <aside id="sidebar" class="w-64 flex-shrink-0 bg-slate-900/80 border-r border-slate-800 flex flex-col transition-all duration-300 z-50 glass-panel">
        
        <!-- Header -->
        <div class="h-16 flex items-center px-6 border-b border-slate-800/50 gap-3">
            <div class="bg-blue-600 p-1.5 rounded-lg shadow-lg shadow-blue-500/20">
                <i data-lucide="box" class="w-5 h-5 text-white"></i>
            </div>
            <h1 class="font-bold text-lg tracking-wide bg-gradient-to-r from-blue-400 to-cyan-300 bg-clip-text text-transparent truncate sidebar-text">
                ToolHub
            </h1>
        </div>

        <!-- Navigation -->
        <div class="flex-1 overflow-y-auto py-4 px-3 space-y-1">
            <button onclick="goHome()" id="nav-home" class="w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm font-medium bg-blue-600/10 text-blue-400 border border-blue-500/20 transition-all cursor-pointer">
                <i data-lucide="layout-grid" class="w-5 h-5"></i>
                <span class="sidebar-text">å·¥å…·ç¸½è¦½</span>
            </button>

            <div class="pt-4 pb-2 px-3 text-xs font-bold text-slate-500 uppercase tracking-wider sidebar-text select-none">
                å¿«é€Ÿå•Ÿå‹•
            </div>
            <div id="quick-launch-list" class="space-y-1">
                <!-- JS å¡«å…… -->
            </div>
        </div>

        <!-- Footer -->
        <div class="p-4 border-t border-slate-800/50">
            <a href="https://github.com" target="_blank" class="flex items-center gap-3 text-slate-400 hover:text-white transition-colors group">
                <i data-lucide="github" class="w-5 h-5 transition-transform group-hover:scale-110"></i>
                <span class="text-xs font-medium sidebar-text">GitHub Repo</span>
            </a>
        </div>
    </aside>

    <!-- ä¸»å…§å®¹å€ -->
    <main class="flex-1 relative overflow-hidden bg-slate-950">
        
        <!-- èƒŒæ™¯è£é£¾ -->
        <div class="absolute inset-0 overflow-hidden pointer-events-none">
            <div class="absolute -top-[20%] -right-[10%] w-[50%] h-[50%] bg-blue-900/10 rounded-full blur-[100px]"></div>
            <div class="absolute top-[40%] -left-[10%] w-[40%] h-[40%] bg-indigo-900/10 rounded-full blur-[100px]"></div>
        </div>

        <!-- 1. å„€è¡¨æ¿è¦–åœ– (Dashboard View) -->
        <div id="dashboard-container" class="absolute inset-0 flex flex-col p-8 overflow-y-auto z-10 custom-scrollbar">
            
            <!-- é ‚éƒ¨æœå°‹èˆ‡éæ¿¾ -->
            <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-8 animate-fade-in">
                <div>
                    <h2 class="text-2xl font-bold text-white mb-1">æ­¡è¿å›ä¾†</h2>
                    <p class="text-slate-400 text-sm">é¸æ“‡ä¸€å€‹å·¥å…·é–‹å§‹å·¥ä½œï¼Œæˆ–å°‡æ–°å·¥å…·åŠ å…¥åˆ—è¡¨ã€‚</p>
                </div>
                
                <div class="flex items-center gap-3 bg-slate-900/50 p-1 rounded-xl border border-slate-800">
                    <div class="relative group">
                        <i data-lucide="search" class="absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-500 group-focus-within:text-blue-400 transition-colors"></i>
                        <input type="text" id="search-input" placeholder="æœå°‹å·¥å…·..." 
                            class="bg-transparent border-none text-sm text-slate-200 pl-9 pr-4 py-2 w-48 md:w-64 focus:outline-none placeholder:text-slate-600">
                    </div>
                </div>
            </div>

            <!-- åˆ†é¡æ¨™ç±¤ -->
            <div class="flex gap-2 mb-6 overflow-x-auto pb-2 animate-fade-in" style="animation-delay: 0.1s">
                <button onclick="filterTools('all')" class="filter-btn active px-4 py-1.5 rounded-full text-xs font-medium bg-slate-800 text-slate-300 border border-slate-700 hover:bg-slate-700 hover:text-white transition-all data-[active=true]:bg-blue-600 data-[active=true]:text-white data-[active=true]:border-blue-500">
                    å…¨éƒ¨
                </button>
                <button onclick="filterTools('Image')" class="filter-btn px-4 py-1.5 rounded-full text-xs font-medium bg-slate-800 text-slate-300 border border-slate-700 hover:bg-slate-700 hover:text-white transition-all">
                    å½±åƒè™•ç† (Image)
                </button>
                <button onclick="filterTools('Creative')" class="filter-btn px-4 py-1.5 rounded-full text-xs font-medium bg-slate-800 text-slate-300 border border-slate-700 hover:bg-slate-700 hover:text-white transition-all">
                    å‰µæ„è¨­è¨ˆ (Creative)
                </button>
                <button onclick="filterTools('AI')" class="filter-btn px-4 py-1.5 rounded-full text-xs font-medium bg-slate-800 text-slate-300 border border-slate-700 hover:bg-slate-700 hover:text-white transition-all">
                    AI å·¥å…· (AI)
                </button>
            </div>

            <!-- å·¥å…·ç¶²æ ¼ -->
            <div id="tools-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 pb-10">
                <!-- JS ç”Ÿæˆå¡ç‰‡ -->
            </div>

            <!-- ç©ºç‹€æ…‹æç¤º -->
            <div id="empty-state" class="hidden flex-col items-center justify-center py-20 text-slate-500">
                <i data-lucide="ghost" class="w-12 h-12 mb-4 opacity-50"></i>
                <p>æ‰¾ä¸åˆ°ç¬¦åˆçš„å·¥å…·</p>
            </div>
            
        </div>

        <!-- 2. æ‡‰ç”¨ç¨‹å¼è¦–åœ– (Iframe Container) -->
        <div id="app-frame-container" class="absolute inset-0 bg-white z-20 hidden-app flex flex-col">
            <!-- App Toolbar -->
            <div class="h-10 bg-slate-900 border-b border-slate-800 flex items-center justify-between px-4 flex-shrink-0">
                <div class="flex items-center gap-3">
                    <button onclick="goHome()" class="text-slate-400 hover:text-white flex items-center gap-1 text-xs font-medium transition-colors">
                        <i data-lucide="arrow-left" class="w-3.5 h-3.5"></i>
                        è¿”å›
                    </button>
                    <div class="h-4 w-px bg-slate-700"></div>
                    <span id="active-app-title" class="text-sm font-bold text-slate-200 flex items-center gap-2">
                        <!-- App Icon & Title -->
                    </span>
                </div>
                <div class="flex items-center gap-2">
                    <button onclick="reloadApp()" class="p-1.5 text-slate-400 hover:text-white hover:bg-slate-800 rounded transition-colors" title="é‡æ–°æ•´ç†">
                        <i data-lucide="refresh-cw" class="w-3.5 h-3.5"></i>
                    </button>
                    <button onclick="openInNewTab()" class="p-1.5 text-slate-400 hover:text-white hover:bg-slate-800 rounded transition-colors" title="åœ¨æ–°åˆ†é é–‹å•Ÿ">
                        <i data-lucide="external-link" class="w-3.5 h-3.5"></i>
                    </button>
                </div>
            </div>
            
            <!-- The Iframe -->
            <iframe id="app-iframe" class="flex-1 w-full h-full border-none bg-slate-900" sandbox="allow-scripts allow-same-origin allow-forms allow-downloads allow-modals allow-popups"></iframe>
        </div>

    </main>

    <!-- JAVASCRIPT CONFIGURATION -->
    <script>
        // ============================================
        // ğŸ”§ è¨­å®šå€åŸŸï¼šåœ¨æ­¤è™•æ–°å¢æˆ–ä¿®æ”¹ä½ çš„å·¥å…·
        // ============================================
        const toolsConfig = [
            {
                id: 'renamer',
                title: 'Visual Renamer',
                description: 'è¦–è¦ºåŒ–æ‰¹æ¬¡åœ–ç‰‡é‡æ–°å‘½åå·¥å…·ï¼Œæ”¯æ´æ‹–æ›³æ’åºã€æ ¼å¼è½‰æ›èˆ‡ Exif æ¸…é™¤ã€‚',
                file: 'Rename.html',  // ä½ çš„ HTML æª”å
                icon: 'image',        // Lucide Icon åç¨±
                color: 'text-blue-400',
                bg: 'bg-blue-500/10',
                category: 'Image',
                tags: ['Utility', 'Batch']
            },
            {
                id: 'typesetter',
                title: 'æ¼«ç•«åµŒå­—ç¥å™¨ Pro(æœªå®Œæˆ)',
                description: 'åŸºæ–¼ Canvas çš„ç·šä¸ŠåµŒå­—å·¥å…·ï¼Œæ”¯æ´è‡ªè¨‚å­—å‹ä¸Šå‚³ã€å°è©±æ¡†ç·¨è¼¯èˆ‡å°ˆæ¡ˆå°å‡ºã€‚',
                file: 'TextWeb.html', // ä½ çš„ HTML æª”å
                icon: 'type',
                color: 'text-purple-400',
                bg: 'bg-purple-500/10',
                category: 'Creative',
                tags: ['Editor', 'Design']
            },
            {
                id: 'comfyui',
                title: 'ComfyUI Tag Extractor',
                description: 'è®€å– ComfyUI ç”Ÿæˆçš„ PNG åœ–ç‰‡ï¼Œå¿«é€Ÿåˆ†æ Promptã€Modelã€Seed èˆ‡ Workflow è³‡è¨Šã€‚',
                file: 'ComfyUI Tag Extractor.html', // ä½ çš„ HTML æª”å
                icon: 'cpu',
                color: 'text-green-400',
                bg: 'bg-green-500/10',
                category: 'AI',
                tags: ['Metadata', 'Analysis']
            },
            {
                id: 'wildcard', 
                title: 'Weighted Prompt Studio', // å»ºè­°æ”¹æˆå·¥å…·å…§çš„å¯¦éš›åç¨±
                description: 'é€²éšæ¬Šé‡ Prompt ç·¨è¼¯å™¨ï¼Œæ”¯æ´å€å¡Šç®¡ç†ã€CSV åŒ¯å…¥ã€æ©Ÿç‡æ¨¡æ“¬èˆ‡èªæ³•ç”Ÿæˆã€‚',
                file: 'Wildcard.html', // ä¿®æ­£ï¼šæŒ‡å‘æ­£ç¢ºçš„æª”æ¡ˆåç¨±
                icon: 'shuffle',       // ä¿®æ­£ï¼šä½¿ç”¨æ›´ç¬¦åˆ "éš¨æ©Ÿ/æ¬Šé‡" æ¦‚å¿µçš„åœ–æ¨™
                color: 'text-orange-400', // ä¿®æ”¹ï¼šä½¿ç”¨æ©˜è‰²ç³»ï¼Œèˆ‡ç¶ è‰²çš„ Tag Extractor å€éš”
                bg: 'bg-orange-500/10',
                category: 'AI',
                tags: ['Prompt', 'Editor'] // æ›´æ–°æ¨™ç±¤
            }
        ];

        // ============================================
        // é‚è¼¯ç¨‹å¼ç¢¼
        // ============================================

        // ç‹€æ…‹è®Šæ•¸
        let currentFilter = 'all';
        let searchQuery = '';
        let activeToolId = null;

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', () => {
            renderTools();
            renderQuickLaunch();
            
            // ç¢ºä¿åœ–æ¨™æ¸²æŸ“
            if (typeof lucide !== 'undefined') {
                lucide.createIcons();
            }

            // æœå°‹ç›£è½
            const searchInput = document.getElementById('search-input');
            if (searchInput) {
                searchInput.addEventListener('input', (e) => {
                    searchQuery = e.target.value.toLowerCase();
                    renderTools();
                });
            }
        });

        // æ¸²æŸ“å·¥å…·å¡ç‰‡ (å„€è¡¨æ¿)
        function renderTools() {
            const container = document.getElementById('tools-grid');
            const emptyState = document.getElementById('empty-state');
            if (!container) return;
            
            container.innerHTML = '';

            const filtered = toolsConfig.filter(tool => {
                const matchesCategory = currentFilter === 'all' || tool.category === currentFilter;
                const matchesSearch = tool.title.toLowerCase().includes(searchQuery) || 
                                      tool.description.toLowerCase().includes(searchQuery) ||
                                      tool.tags.some(t => t.toLowerCase().includes(searchQuery));
                return matchesCategory && matchesSearch;
            });

            if (filtered.length === 0) {
                emptyState.classList.remove('hidden');
                emptyState.classList.add('flex');
            } else {
                emptyState.classList.add('hidden');
                emptyState.classList.remove('flex');
            }

            filtered.forEach((tool, index) => {
                const delay = index * 0.05;
                const card = document.createElement('div');
                card.className = `tool-card glass-panel rounded-xl p-5 flex flex-col gap-4 cursor-pointer group border border-slate-700/50 animate-slide-up`;
                card.style.animationDelay = `${delay}s`;
                // ç¶å®šé»æ“Šäº‹ä»¶
                card.onclick = function() { launchApp(tool.id); };

                card.innerHTML = `
                    <div class="flex justify-between items-start">
                        <div class="p-3 rounded-lg ${tool.bg} border border-white/5">
                            <i data-lucide="${tool.icon}" class="w-6 h-6 ${tool.color}"></i>
                        </div>
                        <button class="opacity-0 group-hover:opacity-100 transition-opacity p-2 text-slate-400 hover:text-white" title="åœ¨æ–°åˆ†é é–‹å•Ÿ" onclick="event.stopPropagation(); window.open('${tool.file}', '_blank')">
                            <i data-lucide="external-link" class="w-4 h-4"></i>
                        </button>
                    </div>
                    
                    <div>
                        <h3 class="font-bold text-lg text-slate-100 group-hover:text-blue-300 transition-colors mb-1">${tool.title}</h3>
                        <p class="text-sm text-slate-400 line-clamp-2 leading-relaxed">${tool.description}</p>
                    </div>

                    <div class="mt-auto pt-4 border-t border-slate-700/50 flex justify-between items-center">
                        <div class="flex gap-2">
                            ${tool.tags.map(tag => `<span class="text-[10px] uppercase font-bold tracking-wider px-2 py-0.5 rounded bg-slate-800 text-slate-400 border border-slate-700">${tag}</span>`).join('')}
                        </div>
                        <span class="text-xs font-medium text-blue-500 opacity-0 group-hover:opacity-100 transition-all transform translate-x-[-10px] group-hover:translate-x-0 flex items-center gap-1">
                            å•Ÿå‹• <i data-lucide="arrow-right" class="w-3 h-3"></i>
                        </span>
                    </div>
                `;
                container.appendChild(card);
            });
            
            if (typeof lucide !== 'undefined') lucide.createIcons();
        }

        // æ¸²æŸ“å´é‚Šæ¬„å¿«é€Ÿå•Ÿå‹• (ä¿®æ­£ç‰ˆ)
        function renderQuickLaunch() {
            const list = document.getElementById('quick-launch-list');
            if (!list) return;
            
            list.innerHTML = '';
            
            toolsConfig.forEach(tool => {
                const btn = document.createElement('button');
                btn.className = `w-full flex items-center gap-3 px-3 py-2 rounded-lg text-sm text-slate-400 hover:text-slate-100 hover:bg-slate-800 transition-all group cursor-pointer select-none`;
                
                // ç›´æ¥ç¶å®šå‡½æ•¸ï¼Œé¿å…ä½œç”¨åŸŸå•é¡Œ
                btn.onclick = function() { 
                    launchApp(tool.id); 
                };

                btn.innerHTML = `
                    <i data-lucide="${tool.icon}" class="w-4 h-4 ${tool.color} opacity-70 group-hover:opacity-100 pointer-events-none"></i>
                    <span class="truncate sidebar-text pointer-events-none">${tool.title}</span>
                `;
                list.appendChild(btn);
            });
            
            // é‡æ–°æ¸²æŸ“æ–°åŠ å…¥çš„åœ–æ¨™
            if (typeof lucide !== 'undefined') lucide.createIcons();
        }

        // éæ¿¾åŠŸèƒ½
        function filterTools(category) {
            currentFilter = category;
            
            // æ›´æ–°æŒ‰éˆ•æ¨£å¼
            document.querySelectorAll('.filter-btn').forEach(btn => {
                if (btn.getAttribute('onclick').includes(`'${category}'`)) {
                    btn.setAttribute('data-active', 'true');
                    btn.classList.add('bg-blue-600', 'text-white', 'border-blue-500');
                    btn.classList.remove('bg-slate-800', 'text-slate-300', 'border-slate-700');
                } else {
                    btn.removeAttribute('data-active');
                    btn.classList.remove('bg-blue-600', 'text-white', 'border-blue-500');
                    btn.classList.add('bg-slate-800', 'text-slate-300', 'border-slate-700');
                }
            });

            renderTools();
        }

        // å•Ÿå‹• App (æ ¸å¿ƒé‚è¼¯)
        function launchApp(id) {
            const tool = toolsConfig.find(t => t.id === id);
            if (!tool) {
                console.error('Tool not found:', id);
                return;
            }

            activeToolId = id;

            // UI å…ƒç´ 
            const dashboard = document.getElementById('dashboard-container');
            const appFrame = document.getElementById('app-frame-container');
            const iframe = document.getElementById('app-iframe');
            const sidebar = document.getElementById('sidebar');
            const activeTitle = document.getElementById('active-app-title');

            // 1. è¨­å®šæ¨™é¡Œèˆ‡ Icon
            activeTitle.innerHTML = `<i data-lucide="${tool.icon}" class="w-4 h-4 ${tool.color}"></i> ${tool.title}`;
            if (typeof lucide !== 'undefined') lucide.createIcons();

            // 2. è¼‰å…¥ Iframe
            iframe.src = tool.file;

            // 3. åŸ·è¡Œè½‰å ´
            dashboard.classList.add('hidden-dash');
            appFrame.classList.remove('hidden-app');
            appFrame.classList.add('active-app');
            
            // 4. æ”¶ç¸®å´é‚Šæ¬„
            sidebar.classList.add('w-16');
            sidebar.classList.remove('w-64');
            
            // éš±è—æ–‡å­—
            const texts = document.querySelectorAll('.sidebar-text');
            texts.forEach(el => el.classList.add('hidden'));

            // æ›´æ–°é¸å–®ç‹€æ…‹
            const homeBtn = document.getElementById('nav-home');
            homeBtn.classList.remove('bg-blue-600/10', 'text-blue-400');
            homeBtn.classList.add('text-slate-400', 'hover:text-white');
        }

        // è¿”å›ä¸»é 
        function goHome() {
            const dashboard = document.getElementById('dashboard-container');
            const appFrame = document.getElementById('app-frame-container');
            const iframe = document.getElementById('app-iframe');
            const sidebar = document.getElementById('sidebar');
            const homeBtn = document.getElementById('nav-home');

            dashboard.classList.remove('hidden-dash');
            appFrame.classList.add('hidden-app');
            appFrame.classList.remove('active-app');

            // å»¶é²æ¸…ç©º iframe
            setTimeout(() => {
                iframe.src = 'about:blank';
                activeToolId = null;
            }, 300);

            // å±•é–‹å´é‚Šæ¬„
            sidebar.classList.remove('w-16');
            sidebar.classList.add('w-64');
            
            // é¡¯ç¤ºæ–‡å­— (å»¶é²ä»¥é…åˆå‹•ç•«)
            setTimeout(() => {
                const texts = document.querySelectorAll('.sidebar-text');
                texts.forEach(el => el.classList.remove('hidden'));
            }, 100);

            homeBtn.classList.add('bg-blue-600/10', 'text-blue-400');
            homeBtn.classList.remove('text-slate-400', 'hover:text-white');
        }

        function reloadApp() {
            if(activeToolId) {
                const iframe = document.getElementById('app-iframe');
                iframe.contentWindow.location.reload();
            }
        }

        function openInNewTab() {
            if(activeToolId) {
                const tool = toolsConfig.find(t => t.id === activeToolId);
                if(tool) window.open(tool.file, '_blank');
            }
        }

        // å°‡å‡½æ•¸æ›è¼‰åˆ° Window ä»¥ä¾› HTML onclick ä½¿ç”¨
        window.filterTools = filterTools;
        window.launchApp = launchApp;
        window.goHome = goHome;
        window.reloadApp = reloadApp;
        window.openInNewTab = openInNewTab;

    </script>
</body>
</html>